---
import Layout from "../layouts/Layout.astro";
import { Image } from "astro:assets";

// Import images for carousel
import hero1 from "../assets/images/portfolio/20.jpg";
import hero2 from "../assets/images/portfolio/hero-2.jpg";
import hero3 from "../assets/images/portfolio/hero-3.jpg";

// Import images for featured work (example IDs 1, 10, 20, 40)
import feat1 from "../assets/images/portfolio/1.jpg";
import feat10 from "../assets/images/portfolio/10.jpg";
import feat20 from "../assets/images/portfolio/20.jpg";
import feat40 from "../assets/images/portfolio/40.jpg";

import profileImage from "../assets/images/profile.png";

// Carousel images - solo 3 para el Hero de la página de inicio
const carouselImages = [
  {
    id: 1,
    title: "Street Photography",
    subtitle: "Documentando historias efímeras en las calles de la ciudad",
    asset: hero1,
  },
  {
    id: 2,
    title: "Restaurantes",
    subtitle: "Fotografía gastronómica y de espacios culinarios",
    asset: hero2,
  },
  {
    id: 3,
    title: "Paisajes Urbanos",
    subtitle: "Perspectivas únicas de nuestra arquitectura moderna",
    asset: hero3,
  },
];

// Featured work images
const featuredWork = [
  { id: 1, title: "Retrato Artístico", asset: feat1 },
  { id: 10, title: "Arquitectura Moderna", asset: feat10 },
  { id: 20, title: "Vida Urbana", asset: feat20 },
  { id: 40, title: "Gastronomía", asset: feat40 },
];
---

<Layout title="Inicio - Portafolio de Fotografía">
  <!-- Carousel Section - Hero -->
  <section id="carousel" class="carousel-hero">
    <div class="carousel-container-full">
      <div class="carousel-wrapper-full">
        <div class="carousel-track" id="carouselTrack">
          {
            carouselImages.map((image, index) => (
              <div class="carousel-slide">
                <Image
                  src={image.asset}
                  alt={image.title}
                  width={1920}
                  height={1080}
                  loading={index === 0 ? "eager" : "lazy"}
                  decoding="async"
                  class="carousel-img"
                />
                <div class="carousel-overlay">
                  <div class="carousel-content">
                    <h1>{image.title}</h1>
                    <p class="carousel-subtitle">{image.subtitle}</p>
                  </div>
                </div>
              </div>
            ))
          }
        </div>
      </div>

      <div class="carousel-dots" id="carouselDots">
        {
          carouselImages.map((_, index) => (
            <button
              class={`dot ${index === 0 ? "active" : ""}`}
              data-index={index}
              aria-label={`Go to slide ${index + 1}`}
            />
          ))
        }
      </div>
    </div>
  </section>

  <!-- Featured Work Section -->
  <section id="featured-work" class="featured-work">
    <div class="container">
      <h2 class="featured-work-title">Un poco de mi Trabajo</h2>
      <div class="featured-grid">
        {
          featuredWork.map((image) => (
            <div class="featured-item">
              <div
                class="featured-image-wrapper"
                data-image-id={image.id}
                data-image-title={image.title}
                data-src={image.asset.src}
              >
                <Image
                  src={image.asset}
                  alt={image.title}
                  width={600}
                  height={750}
                  loading="lazy"
                  decoding="async"
                />
              </div>
            </div>
          ))
        }
      </div>
      <div class="featured-cta">
        <a href="/portfolio" class="btn">Ver Portafolio Completo</a>
      </div>
    </div>
  </section>

  <!-- Lightbox for Featured Work -->
  <div id="featuredLightbox" class="lightbox">
    <button
      class="lightbox-close"
      id="closeFeaturedLightbox"
      aria-label="Close lightbox">&times;</button
    >
    <img id="featuredLightboxImage" src="" alt="" />
  </div>

  <!-- About Section -->
  <section id="about" class="about">
    <div class="container">
      <h2 class="about-title">Sobre Mi</h2>
      <div class="about-content">
        <div class="about-text-content">
          <p class="about-text">
            ¡Hola! Soy Javier, un fotógrafo autodidacta apasionado por capturar
            la esencia de Bolivia, su gente y sus historias. Con 5 años de
            trayectoria, he tenido el honor de ser reconocido por la Unión
            Europea (2022) y exponer mi trabajo en el Hotel Kunan (2025).
          </p>
          <p class="about-text">
            Mi motivación es conectar con la identidad de cada proyecto, ya sea
            en la gastronomía, el retrato o la vida urbana. Disfruto de cada
            nuevo desafío y me encantaría escuchar tu idea para, juntos, hacerla
            realidad :)
          </p>
          <a href="/contact" class="btn">Trabajemos Juntos</a>
        </div>
        <div class="about-image">
          <Image
            src={profileImage}
            alt="Perfil del fotógrafo"
            width={400}
            height={400}
          />
        </div>
      </div>
    </div>
  </section>
</Layout>

<style>
  /* Carousel Hero Section */
  .carousel-hero {
    position: relative;
    width: 100%;
    height: 113vh;
    min-height: 600px;
    overflow: hidden;
    padding-top: 70px;
    box-sizing: border-box;
  }

  .carousel-container-full {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
  }

  .carousel-wrapper-full {
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  .carousel-track {
    display: flex;
    height: 100%;
    transition: transform 0.6s ease-in-out;
  }

  .carousel-slide {
    min-width: 100%;
    height: 100%;
    position: relative;
  }

  .carousel-slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    filter: grayscale(100%);
    transition: filter var(--transition-medium);
  }

  .carousel-slide:hover img {
    filter: grayscale(0%);
  }

  .carousel-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0.3) 0%,
      rgba(0, 0, 0, 0.6) 100%
    );
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .carousel-content {
    text-align: center;
    color: var(--color-white);
    max-width: 800px;
    padding: 2rem;
    animation: fadeInUp 0.8s ease forwards;
  }

  .carousel-content h1 {
    font-size: clamp(2.5rem, 5vw, 4rem);
    margin-bottom: 1.5rem;
    color: var(--color-white);
  }

  .carousel-subtitle {
    font-size: clamp(1.1rem, 2vw, 1.3rem);
    color: var(--color-white);
    margin-bottom: 2.5rem;
    font-weight: 300;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    opacity: 0.9;
  }

  .carousel-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background-color: rgba(255, 255, 255, 0.9);
    border: 2px solid var(--color-white);
    color: var(--color-black);
    width: 60px;
    height: 60px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    transition: all var(--transition-fast);
    z-index: 10;
  }

  .carousel-btn.prev {
    left: 2rem;
  }

  .carousel-btn.next {
    right: 2rem;
  }

  .carousel-btn:hover {
    background-color: var(--color-white);
    transform: translateY(-50%) scale(1.1);
  }

  .carousel-btn span {
    line-height: 1;
    margin-top: -4px;
  }

  .carousel-dots {
    position: absolute;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 1rem;
    z-index: 10;
  }

  .dot {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.5);
    border: 2px solid var(--color-white);
    cursor: pointer;
    transition: all var(--transition-fast);
  }

  .dot.active {
    background-color: var(--color-white);
    transform: scale(1.3);
  }

  .dot:hover {
    background-color: var(--color-white);
  }

  /* Featured Work Section */
  .featured-work {
    background-color: var(--bg-primary);
    padding: 2rem 0 0;
    min-height: 0.5vh;
  }

  .featured-work-title {
    text-align: center;
    margin-bottom: 1.5rem;
    font-size: clamp(2rem, 4vw, 2.5rem);
  }

  .featured-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1.5rem;
    max-width: 1600px;
    margin: 0 auto 1.5rem;
  }

  .featured-item {
    position: relative;
    overflow: hidden;
    aspect-ratio: 4/5;
  }

  .featured-image-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
    border: 1px solid var(--border-color);
    transition: transform var(--transition-medium);
    cursor: pointer;
  }

  .featured-item:hover .featured-image-wrapper {
    transform: translateY(-5px);
  }

  .featured-image-wrapper img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: grayscale(100%);
    transition:
      transform var(--transition-slow),
      filter var(--transition-medium);
  }

  .featured-item:hover .featured-image-wrapper img {
    transform: scale(1.05);
    filter: grayscale(0%);
  }

  .featured-cta {
    text-align: center;
  }

  /* Lightbox */
  .lightbox {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.95);
    z-index: 2000;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    opacity: 0;
    transition: opacity var(--transition-medium);
  }

  .lightbox.active {
    display: flex;
    opacity: 1;
  }

  .lightbox-close {
    position: absolute;
    top: 2rem;
    right: 2rem;
    background: none;
    border: none;
    color: var(--color-white);
    font-size: 3rem;
    cursor: pointer;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform var(--transition-fast);
    z-index: 2001;
  }

  .lightbox-close:hover {
    transform: rotate(90deg);
  }

  .lightbox img {
    max-width: 90%;
    max-height: 85vh;
    object-fit: contain;
    box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
  }

  /* About Section */
  .about {
    background-color: var(--bg-primary);
    padding: 2rem 0 var(--spacing-xl);
    min-height: auto;
  }

  .about-title {
    text-align: left;
    margin-bottom: 3rem;
    font-size: clamp(2rem, 4vw, 2.5rem);
  }

  .about-content {
    max-width: 1200px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 5rem;
    align-items: center;
  }

  .about-image {
    width: 100%;
    max-width: 400px;
    margin: 0 auto;
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .about-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
    border: 2px solid var(--text-primary);
    box-shadow: 0 10px 30px var(--shadow-color);
  }

  .about-text-content {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    justify-content: center;
    text-align: left;
  }

  .about-text {
    font-size: 1.1rem;
    line-height: 1.8;
    margin: 0;
    color: var(--text-secondary);
  }

  .about-text-content .btn {
    align-self: flex-start;
    margin-top: 1rem;
  }

  @media (max-width: 768px) {
    .carousel-hero {
      min-height: 500px;
    }

    .carousel-btn {
      width: 45px;
      height: 45px;
      font-size: 2rem;
    }

    .carousel-btn.prev {
      left: 1rem;
    }

    .carousel-btn.next {
      right: 1rem;
    }

    .carousel-content h1 {
      font-size: 2rem;
    }

    .carousel-subtitle {
      font-size: 1rem;
    }

    .featured-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }

    .about-content {
      grid-template-columns: 1fr;
      gap: 2rem;
      text-align: center;
    }

    .about-image {
      max-width: 250px;
      margin: 0 auto;
    }

    .about-text {
      font-size: 1rem;
    }

    .about-text-content .btn {
      align-self: center;
    }
  }
</style>

<script>
  const track = document.getElementById("carouselTrack");
  const dots = document.querySelectorAll(".dot");

  let currentIndex = 0;
  const totalSlides = 3; // Changed to 3 images
  let autoPlayInterval: number;

  function updateCarousel() {
    if (track) {
      track.style.transform = `translateX(-${currentIndex * 100}%)`;
    }

    dots.forEach((dot, index) => {
      dot.classList.toggle("active", index === currentIndex);
    });
  }

  function nextSlide() {
    currentIndex = (currentIndex + 1) % totalSlides;
    updateCarousel();
  }

  function goToSlide(index: number) {
    currentIndex = index;
    updateCarousel();
  }

  function startAutoPlay() {
    // Clear any existing interval to prevent duplicates
    stopAutoPlay();
    autoPlayInterval = window.setInterval(nextSlide, 6000);
  }

  function stopAutoPlay() {
    clearInterval(autoPlayInterval);
  }

  function resetAutoPlay() {
    stopAutoPlay();
    startAutoPlay();
  }

  // Dot navigation
  dots.forEach((dot, index) => {
    dot.addEventListener("click", () => {
      goToSlide(index);
      resetAutoPlay();
    });
  });

  // Pause on hover
  const carouselContainer = document.querySelector(".carousel-hero");
  carouselContainer?.addEventListener("mouseenter", stopAutoPlay);
  carouselContainer?.addEventListener("mouseleave", startAutoPlay);

  // Start auto-play
  startAutoPlay();

  // Featured Work Lightbox functionality
  const featuredLightbox = document.getElementById("featuredLightbox");
  const featuredLightboxImage = document.getElementById(
    "featuredLightboxImage",
  ) as HTMLImageElement;
  const closeFeaturedLightbox = document.getElementById(
    "closeFeaturedLightbox",
  );
  const featuredImageWrappers = document.querySelectorAll(
    ".featured-image-wrapper",
  );

  featuredImageWrappers.forEach((wrapper) => {
    wrapper.addEventListener("click", () => {
      const imageId = (wrapper as HTMLElement).dataset.imageId;
      const imageTitle = (wrapper as HTMLElement).dataset.imageTitle || "";
      const imageSrc = (wrapper as HTMLElement).dataset.src || "";

      if (featuredLightboxImage && featuredLightbox) {
        featuredLightboxImage.src = imageSrc;
        featuredLightboxImage.alt = imageTitle;
        featuredLightbox.classList.add("active");
        document.body.style.overflow = "hidden";
      }
    });
  });

  closeFeaturedLightbox?.addEventListener("click", () => {
    featuredLightbox?.classList.remove("active");
    document.body.style.overflow = "auto";
  });

  featuredLightbox?.addEventListener("click", (e) => {
    if (e.target === featuredLightbox) {
      featuredLightbox.classList.remove("active");
      document.body.style.overflow = "auto";
    }
  });

  // Close lightbox with Escape key
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && featuredLightbox?.classList.contains("active")) {
      featuredLightbox.classList.remove("active");
      document.body.style.overflow = "auto";
    }
  });
</script>
